<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login / Register - Book Shelf Explorer</title>
  <meta name="theme-color" content="#0d6efd" />
  <link rel="manifest" href="../manifest.json" />
  <link rel="apple-touch-icon" sizes="192x192" href="../assets/icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="512x512" href="../assets/icons/icon-512.png">
  <link rel="stylesheet" href="../assets/css/main.css" />
  <link rel="stylesheet" href="../assets/css/components.css" />
  <link rel="stylesheet" href="../assets/css/responsive.css" />
  <link rel="stylesheet" href="../assets/css/google-books.css" />
  <script src="../assets/js/config.js"></script>
  <script src="../assets/js/login.js" defer></script>
  <script src="../assets/js/main.js" defer></script>
  <script src="../assets/js/layout.js" defer></script>
</head>
<body>
  <header></header>

  <main>
    <div class="container">
      <div class="category-hero">
        <h1>Access Your Library</h1>
        <p>Create an account or sign in to keep your session active. (Local-only authentication)</p>
      </div>
      <div class="auth-wrapper" id="auth-wrapper">
        <!-- Login Panel -->
        <div class="auth-panel" id="login-panel">
          <h2>Welcome Back</h2>
            <p class="subtitle">Sign in to continue exploring books</p>
            <div class="auth-alert" id="login-alert"></div>
            <form id="login-form" onsubmit="loginManager.handleLogin(event)">
              <div class="form-group">
                <label for="login-username" class="form-label">Email</label>
                <input type="text" id="login-username" class="form-input" required />
              </div>
              <div class="form-group">
                <label for="login-password" class="form-label">Password</label>
                <input type="password" id="login-password" class="form-input" required />
              </div>
              <div class="remember-row">
                <label><input type="checkbox" id="remember-me" /> Remember me</label>
                <span class="switch-link" onclick="toggleAuth('register')">Need an account?</span>
              </div>
              <button type="submit" class="btn btn-primary" style="margin-top:18px;width:100%;">Login</button>
            </form>
        </div>
        <!-- Register Panel -->
        <div class="auth-panel" id="register-panel" style="display:none;">
          <h2>Create Account</h2>
          <p class="subtitle">Join and start reading instantly</p>
          <div class="auth-alert" id="register-alert"></div>
          <form id="register-form" onsubmit="loginManager.handleRegister(event)">
            <div class="form-group">
              <label for="reg-username" class="form-label">Username</label>
              <input id="reg-username" type="text" class="form-input" required />
            </div>
            <div class="form-inline-split">
              <div class="form-group">
                <label for="reg-password" class="form-label">Password</label>
                <input id="reg-password" type="password" minlength="6" class="form-input" required />
              </div>
              <div class="form-group">
                <label for="reg-password2" class="form-label">Confirm</label>
                <input id="reg-password2" type="password" minlength="6" class="form-input" required />
              </div>
            </div>
            <div class="form-group">
              <label for="reg-email" class="form-label">Email</label>
              <input id="reg-email" type="email" class="form-input" placeholder="you@example.com" />
            </div>
            <div style="font-size:.7rem;color:var(--text-light);margin-top:-6px;">Passwords are stored locally only .</div>
            <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
              <span class="switch-link" onclick="toggleAuth('login')">Have an account?</span>
            </div>
            <button type="submit" class="btn btn-primary" style="margin-top:18px;width:100%;">Create Account</button>
          </form>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div style="max-width:900px;margin:40px auto 60px;padding:0 16px;font-size:.55rem;display:flex;justify-content:flex-end;opacity:.5;">
      <a href="admin.html" style="text-decoration:none;color:inherit;">Admin</a>
    </div>
  </footer>

  <script>
    function toggleAuth(mode){
      const loginPanel = document.getElementById('login-panel');
      const registerPanel = document.getElementById('register-panel');
      loginPanel.style.display = mode==='login' ? 'block':'none';
      registerPanel.style.display = mode==='register' ? 'block':'none';
      (mode==='login'?document.getElementById('login-username'):document.getElementById('reg-username')).focus();
    }
    document.addEventListener('DOMContentLoaded',()=>{
      if(window.location.hash === '#register'){ toggleAuth('register'); }
      if(window.loginManager){ loginManager.updateUIForUser && loginManager.updateUIForUser(); }
    });
    // Hook into login manager alerts
    (function(){
      const origSuccess = console.log;
      // Optional extension point if we later add event dispatching
    })();
  </script>
</body>
</html>